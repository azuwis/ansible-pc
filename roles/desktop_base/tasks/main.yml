---
- name: test intel graphic card
  shell: lspci -nn | grep -q 'VGA.*8086'
  register: intel_graphic
  ignore_errors: True
  changed_when: False
- name: intel graphic driver
  apt: name={{ item }}
  when: intel_graphic|success
  with_items:
    - xserver-xorg-video-intel
    - libgl1-mesa-dri
    - libvdpau-va-gl1

- name: desktop base packages
  apt: name={{ item }}
  with_items:
    - xserver-xorg
    - xinit
    - zsh
    - i3-wm
    - i3status
    - dmz-cursor-theme
    - fonts-wqy-microhei
    - fonts-croscore
    - fonts-crosextra-caladea
    - fonts-crosextra-carlito
    - alsa-utils
    - xterm
    - vim-gtk
    - chromium
    - pepperflashplugin-nonfree
    - iceweasel
    - flashplugin-nonfree
    - dialog
    - fcitx-config-gtk
    - fcitx-frontend-gtk2
    - fcitx-frontend-gtk3
    - fcitx-frontend-qt4
    - fcitx-googlepinyin
    - fcitx-ui-classic
    - dbus-x11 # for fcitx
    - im-config

- name: cros fonts settings
  file: src=../conf.avail/{{ item }} dest=/etc/fonts/conf.d/{{ item|replace('62-', '51-0-') }} state=link force=yes
  with_items:
    - 62-google-croscore-cousine-fontconfig.conf
    - 62-google-crosextra-carlito-fontconfig.conf
  tags: test

- name: theme packages
  apt: name={{ item }}
  with_items: theme_pkgs

- name: numix gtk theme
  git: dest=/usr/share/themes/Numix repo=https://github.com/shimmerproject/Numix.git

- name: gtk2 config
  template: src=gtk2.j2 dest=/etc/gtk-2.0/gtkrc

- name: gtk3 config
  template: src=gtk3.j2 dest=/etc/gtk-3.0/settings.ini

- name: zsh config to startx at login
  copy: src=zlogin dest=/home/{{ item.name }}/.zlogin owner={{ item.name }} group={{ item.name }}
  with_items: staff
